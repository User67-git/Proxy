import { useEffect, useState } from "react";

const animeList = [
  "Naruto",
  "Bleach",
  "One Piece",
  "Dragon Ball Z",
  "Hunter x Hunter",
  "Jujutsu Kaisen",
  "Solo Leveling",
  "Sousou no Frieren",
  "Attack on Titan",
  "Demon Slayer",
];

export default function AnimeBrowser() {
  const [animeData, setAnimeData] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    async function fetchAnime() {
      setLoading(true);
      const results = await Promise.all(
        animeList.map(async (title) => {
          const res = await fetch(
            `https://api.jikan.moe/v4/anime?q=${encodeURIComponent(title)}&limit=1`
          );
          const data = await res.json();
          return data.data?.[0];
        })
      );
      setAnimeData(results.filter(Boolean));
      setLoading(false);
    }

    fetchAnime();
  }, []);

  if (loading) return <p className="text-center p-4">Loading anime data...</p>;

  return (
    <div
      style={{
        display: "grid",
        gridTemplateColumns: "repeat(auto-fill, minmax(300px, 1fr))",
        gap: "1.5rem",
        padding: "1rem",
      }}
    >
      {animeData.map((anime) => (
        <div
          key={anime.mal_id}
          style={{
            backgroundColor: "white",
            borderRadius: "16px",
            boxShadow: "0 4px 12px rgba(0, 0, 0, 0.1)",
            overflow: "hidden",
          }}
        >
          <img
            src={anime.images.jpg.image_url}
            alt={anime.title}
            style={{
              width: "100%",
              height: "250px",
              objectFit: "cover",
            }}
          />
          <div style={{ padding: "1rem" }}>
            <h2 style={{ fontSize: "1.25rem", fontWeight: "bold", marginBottom: "0.5rem" }}>
              {anime.title}
            </h2>
            <p style={{ fontSize: "0.9rem", color: "#555", maxHeight: "120px", overflow: "hidden" }}>
              {anime.synopsis}
            </p>
            <a
              href={anime.url}
              target="_blank"
              rel="noopener noreferrer"
              style={{ display: "inline-block", marginTop: "0.75rem", color: "#2b6cb0" }}
            >
              View on MyAnimeList
            </a>
          </div>
        </div>
      ))}
    </div>
  );
}
